From 90c4860d250e7c7df96da993443847dee352af6c Mon Sep 17 00:00:00 2001
From: Hannes Schueller <hannes@yllr.net>
Date: Fri, 26 Dec 2014 11:42:16 +0100
Subject: [PATCH 07/20] settings for HTML5 local storage and database (default:
 disabled)

Patch by Jan Niemeyer <mail@jan-niemeyer.de>
---
 config.h        | 5 +++++
 main.c          | 2 ++
 vimprobablerc.5 | 6 ++++++
 3 files changed, 13 insertions(+)

diff --git a/config.h b/config.h
index 41a1080..e753824 100644
--- a/config.h
+++ b/config.h
@@ -27,6 +27,9 @@ static gboolean escape_input_on_load    = TRUE; /* TRUE will disable automatic f
 static gboolean private_mode            = FALSE; /* TRUE will disable writing to the history file, cookie file and closed file */
 char temp_dir[MAX_SETTING_SIZE]         = "/tmp"; /* location of temporary files, default will be overridden if TEMPDIR is set */
 
+static const gboolean enableLocalstorage = FALSE;
+static const gboolean enableDatabase = FALSE;
+
 char downloads_path[MAX_SETTING_SIZE]   = "";
 char statusfont[MAX_SETTING_SIZE]       = "monospace bold 8";   /* font for status bar */
 
@@ -210,6 +213,8 @@ static Setting browsersettings[] = {
     { "stylesheet",      NULL,               "user-stylesheet-uri",         FALSE,          FALSE,           FALSE,          FALSE  },
     { "resizetextareas", NULL,               "resizable-text-areas",        FALSE,          TRUE,            FALSE,          FALSE  },
     { "webinspector",    NULL,               "enable-developer-extras",     FALSE,          TRUE,            FALSE,          FALSE  },
+    { "localstorage",    NULL,               "enable-html5-local-storage",  FALSE,          TRUE,            FALSE,          FALSE  },
+    { "html5db",         NULL,               "enable-html5-database",       FALSE,          TRUE,            FALSE,          FALSE  },
     { "popups",          NULL,               "javascript-can-open-windows-automatically",FALSE,TRUE,         FALSE,          FALSE  },
 
     { "homepage",        startpage,          "",                            FALSE,          FALSE,           FALSE,          FALSE  },
diff --git a/main.c b/main.c
index 014497a..d70d508 100644
--- a/main.c
+++ b/main.c
@@ -2693,6 +2693,8 @@ setup_settings() {
     g_object_set(G_OBJECT(settings), "enable-plugins", enablePlugins, NULL);
     g_object_set(G_OBJECT(settings), "enable-java-applet", enableJava, NULL);
     g_object_set(G_OBJECT(settings), "enable-page-cache", enablePagecache, NULL);
+    g_object_set(G_OBJECT(settings), "enable-html5-local-storage", enableLocalstorage, NULL);
+    g_object_set(G_OBJECT(settings), "enable-html5-database", enableDatabase, NULL);
     g_object_set(G_OBJECT(settings), "javascript-can-open-windows-automatically", javascriptPopups, NULL);
     filename = g_strdup_printf(USER_STYLESHEET);
     file_url = g_strdup_printf("file://%s", filename);
diff --git a/vimprobablerc.5 b/vimprobablerc.5
index e37a6b2..414cd99 100644
--- a/vimprobablerc.5
+++ b/vimprobablerc.5
@@ -70,6 +70,12 @@ Case sensitive (true) or insensitive tab completion.
 Cookie policy: accept all cookies, no cookies or all but third party
 cookies.
 
+.IP localstorage=[true|false]
+Enable or disable HTML5 local storage (default: false)
+
+.IP html5db=[true|false]
+Enable or disable HTML5 database (default: false)
+
 .IP homepage=URL
 Set the URL of the homepage.
 
-- 
2.1.4

